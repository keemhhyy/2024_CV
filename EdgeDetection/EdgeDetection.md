# Edge Detection

에지 검출 & 영역 분할 : 컴퓨터 비전의 중요 연구 주제  
**에지 검출** ㅣ 특성이 크게 다른 화소 검출  
**영역 분할** ㅣ 비슷한 화소를 묶어 영역 생성  

## 에지 검출
에지 (edge) : 물제 경계에 있는 점  
**미분**을 통해 이루어짐 -> 명암이 급격히 바뀌지는 않고 "램프 에지" 발생  
(명암이 여러 화소에 걸쳐 조금씩 변하는 에지)

 ex. 1차 미분에서 명압값이 커지명 미분값 양수, 작아지면 음수  
에지 발생 여부와 에지 방향을 **1차 미분**에서 앎.  
**2차 미분**에서 램프 에지의 시작과 끝 파악.  
(1차 미분에서 봉우리 찾고, 2차 미분에서 영교차 찾기)  

필터 u- -1 1 -> u= -1 0 1로 확장해서 사용 -> 3*3으로 확장한다면?  

에지 방향을 보고 섰을 때, 왼쪽은 밝고 오른쪽 어둡게 (but 일관성 유지시 반대 설정 무관)  
**f'_x, f'_, 에지 강도, 에지 방향**은 음수를 포함한 실수 >> 32bit 실수형 cv.CV_32F 자료형 설정

## 캐니 에지

1986년 세 가지 기준에 따라 목적 함수를 정의해 에지 검출을 최적화 문제로 해결  
- **최소 오류율** : FN, FP 최소화
- **위치 정확도** : 검출된 에지와 실제 에지 근접해야함
- **단일 에지** : 하나의 에지는 하나의 점으로

FP를 줄이기 위해 T_low, T_high 2개의 이력 임계값 사용  
-> T_high 이상 에지 화소부터 추적하고 T_low 입계값 넘는 에지 대상으로  
   T_low, T_high가 2~3배 되도록 설정 권고   
   
<img src="https://github.com/keemhhyy/2024_CV/assets/147595460/bac362f7-2652-4ab7-bfdf-3ea28688cc20" width="200" height="200">

## 직선 검출

에지 맵에는 에지 화소 1 or 0  
- 연결 관계가 명시적 X
- 에지 화소 연결해 경계선으로 변환하고, 경계선을 직선으로 변환 시, 다음 물체 표현.인식 유리

**허브 변환** : 끊긴 에지들을 모아 선분 or 원 등 검출 변환법  
직선 외에도 어떤 도형이라도 검출 가능  
`ex. 원 (x-a)^2 +(y-b)^2 = r^2 -> a,b,r 3개의 변수로 2차원 누적 배열 사용해서`

  ####   단점
- 두 점만 있는 것이 아닌 많은 점 존재 & 완벽한 직선을 이루지 않음
  -> (a,b)공간을 이산화해 해결
- 투표가 이뤄진 누적 배열에 Noise가 많음
  -> Non-Maximum Suppression 적용
- y=ax+b 사용 시, 기울기 a가 무한대면 투표 불가능
  -> 극좌표계에서 직선의 방정식 표현 식 도입 (xsin(@)+ycos(@)=p)


  **허브 변환** : 두 점 잇는 모든 직선 안의 점 투표
  
  -> 누적 배열에 Noise 많이 발생
  -> 비최대 억제로 문제 해결 시도 -> Outlier 취약
  
  **최소평균제곱오차(LMSE)** : 모든 점 대상으로 오류 계산/최소 오류 직선 탐색
  
  -> 모든 샘플이 같은 가치 -> Outlier 취약

**강인한 추정?** outlier 걸러내는 과정을 가진 추정 기법  
(허브 변환, LMSE는 강인하지 않은 추정)  

**RANSAC** : RANdom SAmple Consensus (무작위 표본 합의)  
1. 랜덤하게 두 점 선택
2. 두 점 지나는 직선 계산. (일정 오차 t 허용해, 직선에 일치하는 점 count)
3. -점의 수 임계값 d 넘지 않으면 버림  
   -임계값 d 넘으면 직선 추정 후, 오류가 임계값 e보다 작으면 후보군 추가/ 아니면 버림

## 영역 분할

물체가 점유한 영역을 구분하는 작업  
**SLIC 알고리즘**  

<img src="https://github.com/keemhhyy/2024_CV/assets/147595460/42ec24d1-0deb-4546-930c-39e75cebeaa3" width="280" height="180">  

- compactness가 올라갈수록 더욱 균일한 segment가 진행됨을 확인.

**최적화 분할** : 정규화 절단 알고리즘을 이용한 영역 분할  
- normalized cut의 값을 최소화 하는 것이 목적  

<img src="https://github.com/keemhhyy/2024_CV/assets/147595460/39b1ffd3-8d70-406d-ba4f-5876af8d7f8e" width="250" height="150">  

## 대화식 분할

GrabCut을 이용한 대화식 분할  

<img src="https://github.com/keemhhyy/2024_CV/assets/147595460/bbbdaefb-e986-4eba-a8d8-9958e06474f6" width="280" height="120">  

## 영역 특징

- 특징과 불변성
  - 특징 : 영상에 나타는 것
  - 불변성 : 변환 해도 특징이 변하지 않는 것
- 텍스쳐 특징
  - 텍스쳐 : 일정한 패턴의 반복
  - 세밀하면 많은 에지 발생, 거칠면 적게 발생

-이진 영역의 특징  

<img src="https://github.com/keemhhyy/2024_CV/assets/147595460/1d381121-eb07-4cb6-883d-b8019e90d929" width="350" height="120">  



   



  

  


